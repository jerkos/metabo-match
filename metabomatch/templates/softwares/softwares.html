{% extends theme("layout.html") %}

{% block keywords %}
    <meta name="keywords" content="omics services, metabolomics, softwares, LC-MS, workflow, peak-picking, alignment, identification, database search, statistical analysis">
    <meta name="description" content="Shows all registered softwares on Metabomatch classified by LC-MS workflow categories">
{% endblock %}

{% block content %}
    <div class="row" style="padding: 0 0 20px 0">
        <h2>Help the community</h2>
        <p> <b>You found a new software and you to share it with the community</b></p>
        <a href="{{url_for('softwares.register')}}" class="btn btn-default">Register new software</a>

    </div>

    <div class="row">
        <h2 class="text-left">Browse by category:</h2>
    </div>

    <hr>

    <div class="row">
        <div class="col-md-3">
            <a href="/softwares?category=1" class="btn btn-primary"><i class="fa fa-tag"></i> Signal Extraction</a>
        </div>
        <div class="col-md-3">
            <a href="/softwares?category=2" class="btn btn-success"><i class="fa fa-tag"></i> LC-alignment</a>
        </div>
        <div class="col-md-3">
            <a href="/softwares?category=3" class="btn btn-warning"><i class="fa fa-tag"></i> Database Search</a>
        </div>
        <div class="col-md-3">
            <a href="/softwares?category=4" class="btn btn-danger"><i class="fa fa-tag"></i> Statistical analysis</a>
        </div>
    </div>

    <div class="row" style="padding: 50px 0 50px 0;">
        <p> Or search a software name: </p>
        <form class="form-inline" role="form" action="{{url_for('softwares.index')}}" method="GET">
            <div class="form-group">
{#                <div class="col-md-8">#}
                 <input type="text" class="form-control" name="text" placeholder="Software name">
{#                </div>#}
            </div>
            <button type="submit" class="btn btn-default">Filter</button>
        </form>
    </div>

    <div class="row">
            <table class="table table-condensed">
                <thead>
                    <tr>
                        <th>Software</th>
                        <th>Programming Language</th>
                        <th>Institute</th>
                        <th>Tags</th>
                        {% if current_user.is_authenticated() %}
                            <th></th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% for soft in softwares %}

                        <tr>
                            <th><a href="{{ url_for('softwares.info', name=soft.name) }}">{{ soft.name }}</a></th>
                            <th>{{ soft.programming_language }}</th>
                            <th>{{ soft.organization }}</th>
                            <th>
                                {% set soft_tags = soft.tags| map(attribute='tag') | join(',') %}
                                {% if 'Signal Extraction' in soft_tags %}
                                    <i class="btn btn-primary fa fa-tag"></i>
                                {% endif %}
                                {% if 'LC Alignment' in soft_tags %}
                                    <i class="btn btn-success fa fa-tag"></i>
                                {% endif %}
                                {% if 'Database Search' in soft_tags %}
                                    <i class="btn btn-warning fa fa-tag"></i>
                                {% endif %}
                                {% if 'Statistical Analysis' in soft_tags %}
                                    <i class="btn btn-danger fa fa-tag"></i>
                                {% endif %}

                            </th>
                            {% if current_user.is_authenticated() and not soft.name in (current_user.softwares_used | map(attribute='name')) %}
                                <th><a class="btn btn-default" href="{{ url_for('softwares.register_user', name=soft.name) }}">Do you use this software ?</a></th>
                            {% elif current_user.is_authenticated() and soft.name in (current_user.softwares_used | map(attribute='name')) %}
                                <th><a class="btn btn-primary" href="/"><i class="fa fa-certificate"></i> software user !</a></th>
                            {% endif %}
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
    </div>
{% endblock %}